#!/opt/perl/bin/perl

use 5.028;

use strict;
use warnings;
no  warnings 'syntax';

use experimental 'signatures';
use experimental 'lexical_subs';

use lib "../lib";

use Getopt::Long;

use Chess::Infinite;

GetOptions  "piece=s"      =>  \(my $piece_name = "knight"),
            "board=s"      =>  \(my $board_name = "spiral"),
            "start=i"      =>  \(my $start      =  1),
            "max_moves=i"  =>  \(my $max_moves  =  10_000),
            "heading=s"    =>  \ my $heading,
;

$board_name = fc $board_name;
$piece_name = fc $piece_name;

my %board2class = (
    fc spiral      =>  "Spiral"
);


die "'$board_name': no such board\n" unless    $board2class {$board_name};

my $board_class = "Chess::Infinite::Board::" . $board2class {$board_name};

my $board = $board_class -> new -> init;
my $piece = piece $piece_name, board    =>  $board,
                               heading  =>  $heading
            or die "'$piece_name': No such piece\n";

$piece -> run (max_moves => $max_moves,
               start     => $start,);

say $piece -> summary;


Chess::Infinite::Grapher:: -> route (piece => $piece);


__END__
